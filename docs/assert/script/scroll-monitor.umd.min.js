/**
 * ScrollMonitor v0.5.0-dev (https://github.com/swgrhck/scroll-monitor)
 * Copyright 2018 Chakwen Hong <swgrhck@gmail.com> (https://swgrhck.github.io/)
 * Licensed under MIT (https://github.com/swgrhck/scroll-monitor/blob/master/LICENSE)
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.scrollMonitor={})}(this,function(t){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");i(t.prototype,e&&e.prototype),e&&i(t,e)}function o(t){return(o=Object.getPrototypeOf||function(t){return t.__proto__})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s,u,f,h,v,d,p,_,g,y,L,E,R,w,m,S,b,O,k,T,A,C,N,M,P,H,W,B,j,D,I,x=(s="target",u="interval",f="scroll",h="DOMContentLoaded",v=[Window,Document,Element],d=new Map,p=function(){function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:50;a(this,r),this.subscriber=t,void 0!==e&&(e=0<Number(e)?Number(e):n,this._ticker={interval:e,ticking:!1})}return e(r,[{key:"resolve",value:function(t,e,n){var r=this,o=[];void 0!==this._ticker?this._ticker.ticking||(this._ticker.ticking=!0,setTimeout(function(){return r._ticker.ticking=!1},this._ticker.interval),this._doResolve(o,t,e,n)):this._doResolve(o,t,e,n),o.forEach(function(t){return r._subscriber.dispatchEvent(t)})}},{key:"_doResolve",value:function(t,e,n,r){}},{key:"subscriber",get:function(){return this._subscriber},set:function(t){if(!(t instanceof EventTarget))throw new Error("The subscriber must be an instance of EventTarget!");this._subscriber=t}}]),r}(),_=function(){function l(t){a(this,l),t=t||window,l._checkTarget(t),d.has(t)&&d.get(t).destroy(),this._target=t,this._resolvers=new Set,this._scrollMetric=l._resolveMetric(t),this._boundEventListener=this._onTargetScroll.bind(this),this._target.addEventListener(f,this._boundEventListener),d.set(t,this)}return e(l,[{key:"addResolver",value:function(t){if("function"==typeof t&&(t={resolve:t}),"function"!=typeof t.resolve)throw new Error("The resolver should have a function named resolve!");this._resolvers.add(t)}},{key:"removeResolver",value:function(t){return this._resolvers.delete(t)}},{key:"clearResolvers",value:function(){var t=this._resolvers;return this._resolvers=new Set,t}},{key:"destroy",value:function(){d.delete(this._target),this._target.removeEventListener(f,this._boundEventListener),this._target=null,this._resolvers=null,this._scrollMetric=null,this._boundEventListener=null}},{key:"_onTargetScroll",value:function(t){var e=this._scrollMetric;this._scrollMetric=l._resolveMetric(this._target);var n=!0,r=!1,o=void 0;try{for(var i,s=this._resolvers[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){i.value.resolve(e,this._scrollMetric,t)}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}}},{key:"target",get:function(){return this._target}},{key:"resolvers",get:function(){return new Set(this._resolvers)}}],[{key:"of",value:function(t){return d.has(t)?d.get(t):new l(t)}},{key:"clear",value:function(){d.forEach(function(t){return t.destroy()})}},{key:"_resolveMetric",value:function(t){var e;if(t instanceof Window){var n=t.document.documentElement;e=new g(n.scrollHeight,n.scrollWidth,n.clientHeight,n.clientWidth,t.pageYOffset,t.pageXOffset)}else{if(!(t instanceof Element))throw new Error("Can not resolve ScrollMetric");e=new g(t.scrollHeight,t.scrollWidth,t.clientHeight,t.clientWidth,t.scrollTop,t.scrollLeft)}return e}},{key:"_checkTarget",value:function(t){for(var e=0;e<v.length;e++){if(t instanceof v[e])return}throw new Error("The target must be an instance of one in ".concat(v.map(function(t){return t.name}).join(", "),"!"))}},{key:"Util",get:function(){return y}},{key:"BaseResolver",get:function(){return p}},{key:"NAMESPACE",get:function(){return"scroll-monitor"}},{key:"monitors",get:function(){return new Map(d)}}]),l}(),g=function(){function s(t,e,n,r,o,i){a(this,s),this._scrollHeight=t,this._scrollWidth=e,this._viewHeight=n,this._viewWidth=r,this._top=o,this._left=i}return e(s,[{key:"scrollHeight",get:function(){return this._scrollHeight}},{key:"scrollWidth",get:function(){return this._scrollWidth}},{key:"viewHeight",get:function(){return this._viewHeight}},{key:"viewWidth",get:function(){return this._viewWidth}},{key:"top",get:function(){return this._top}},{key:"left",get:function(){return this._left}},{key:"bottom",get:function(){return this._scrollHeight-this._top-this._viewHeight}},{key:"right",get:function(){return this._scrollWidth-this._left-this._viewWidth}}]),s}(),y={onLoaded:function(t){window.addEventListener(h,t)},splitString:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:/\s+/g;return(t=t||"").split(e).filter(Boolean)},getTargets:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s,n=t.dataset[e];return n?document.querySelectorAll(n):[window]},getInterval:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u;return t.dataset[e]}},_),U=(L='[data-monitor~="scroll-direction"]',E="scrollUp",R="scrollDown",w="scrollLeft",m="scrollRight",S={SCROLL_UP:"scroll.up.".concat(x.NAMESPACE),SCROLL_DOWN:"scroll.down.".concat(x.NAMESPACE),SCROLL_LEFT:"scroll.left.".concat(x.NAMESPACE),SCROLL_RIGHT:"scroll.right.".concat(x.NAMESPACE)},b=x.Util,O=function(t){function s(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return a(this,s),l(this,o(s).call(this,t,e))}return e(s,[{key:"_doResolve",value:function(t,e,n){n.top<e.top&&t.push(new Event(S.SCROLL_UP)),n.top>e.top&&t.push(new Event(S.SCROLL_DOWN)),n.left<e.left&&t.push(new Event(S.SCROLL_LEFT)),n.left>e.left&&t.push(new Event(S.SCROLL_RIGHT))}}],[{key:"_initByData",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,r=function(){var n=o.value,e=b.getInterval(n);b.getTargets(n).forEach(function(t){return x.of(t).addResolver(new s(n,e))});var r={up:b.splitString(n.dataset[E]),down:b.splitString(n.dataset[R]),left:b.splitString(n.dataset[w]),right:b.splitString(n.dataset[m])};n.addEventListener(S.SCROLL_UP,function(){var t,e;(t=n.classList).add.apply(t,c(r.up)),(e=n.classList).remove.apply(e,c(r.down))}),n.addEventListener(S.SCROLL_DOWN,function(){var t,e;(t=n.classList).add.apply(t,c(r.down)),(e=n.classList).remove.apply(e,c(r.up))}),n.addEventListener(S.SCROLL_LEFT,function(){var t,e;(t=n.classList).add.apply(t,c(r.left)),(e=n.classList).remove.apply(e,c(r.right))}),n.addEventListener(S.SCROLL_RIGHT,function(){var t,e;(t=n.classList).add.apply(t,c(r.right)),(e=n.classList).remove.apply(e,c(r.left))})},i=document.querySelectorAll(L)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)r()}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}}]),n(s,t),s}(x.BaseResolver),b.onLoaded(function(){return O._initByData()}),O),F=(k='[data-monitor~="scroll-near"]',T="nearTop",A="nearBottom",C="nearLeft",N="nearRight",M="distanceTop",P="distanceBottom",H="distanceLeft",W="distanceRight",B={SCROLL_NEAR_TOP:"scroll.near.top.".concat(x.NAMESPACE),SCROLL_NEAR_BOTTOM:"scroll.near.bottom.".concat(x.NAMESPACE),SCROLL_NEAR_LEFT:"scroll.near.left.".concat(x.NAMESPACE),SCROLL_NEAR_RIGHT:"scroll.near.right.".concat(x.NAMESPACE)},j=x.Util,D={top:100,bottom:100,left:100,right:100},I=function(t){function s(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length?arguments[2]:void 0;return a(this,s),(e=l(this,o(s).call(this,t,n,10)))._options=Object.assign({},D,r),e}return e(s,[{key:"_doResolve",value:function(t,e,n){n.top<e.top&&n.top<=this._options.top&&t.push(new Event(B.SCROLL_NEAR_TOP)),n.top>e.top&&n.bottom<=this._options.bottom&&t.push(new Event(B.SCROLL_NEAR_BOTTOM)),n.left<e.left&&n.left<=this._options.left&&t.push(new Event(B.SCROLL_NEAR_LEFT)),n.left>e.left&&n.right<=this._options.right&&t.push(new Event(B.SCROLL_NEAR_RIGHT))}}],[{key:"_initByData",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,r=function(){var n=i.value,e=j.getInterval(n),r={top:Number(n.dataset[M]),bottom:Number(n.dataset[P]),left:Number(n.dataset[H]),right:Number(n.dataset[W])};Object.keys(r).forEach(function(t){return(void 0===r[t]||Number.isNaN(r[t])||r[t]<0)&&delete r[t]}),j.getTargets(n).forEach(function(t){return x.of(t).addResolver(new s(n,e,r))});var o={top:j.splitString(n.dataset[T]),bottom:j.splitString(n.dataset[A]),left:j.splitString(n.dataset[C]),right:j.splitString(n.dataset[N])};n.addEventListener(B.SCROLL_NEAR_TOP,function(){var t,e;(t=n.classList).add.apply(t,c(o.top)),(e=n.classList).remove.apply(e,c(o.bottom))}),n.addEventListener(B.SCROLL_NEAR_BOTTOM,function(){var t,e;(t=n.classList).add.apply(t,c(o.bottom)),(e=n.classList).remove.apply(e,c(o.top))}),n.addEventListener(B.SCROLL_NEAR_LEFT,function(){var t,e;(t=n.classList).add.apply(t,c(o.left)),(e=n.classList).remove.apply(e,c(o.right))}),n.addEventListener(B.SCROLL_NEAR_RIGHT,function(){var t,e;(t=n.classList).add.apply(t,c(o.right)),(e=n.classList).remove.apply(e,c(o.left))})},o=document.querySelectorAll(k)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)r()}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}}}]),n(s,t),s}(x.BaseResolver),j.onLoaded(function(){return I._initByData()}),I);t.Monitor=x,t.ScrollDirectionResolver=U,t.ScrollNearResolver=F,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=scroll-monitor.umd.min.js.map