/**
 * ScrollMonitor v0.1.0 (https://github.com/swgrhck/scroll-monitor)
 * Copyright 2018 Chakwen Hong <swgrhck@gmail.com> (https://swgrhck.github.io/)
 * Licensed under MIT (https://github.com/swgrhck/scroll-monitor/blob/master/LICENSE)
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.scrollMonitor={})}(this,function(e){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function n(e){return(n=Object.getPrototypeOf||function(e){return e.__proto__})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var d,y,o,s,l,a,_,f,v,h,p,b,w,E,g=function(){function e(){i(this,e)}return t(e,[{key:"resolve",value:function(e,t,n){throw new Error("Method is not implemented. Instance must override this method to resolve scroll event!")}},{key:"eventTypes",get:function(){}}],[{key:"VERSION",get:function(){return"0.1.0"}},{key:"NAMESPACE",get:function(){return"scroll-monitor"}}]),e}(),k=(d='[data-monitor~="scroll"]',y="monitorTarget",o="scroll",s="DOMContentLoaded",l=[Window,Element],a=new Map,_=new Set,f=function(){function h(e){i(this,h),e=e||window,h._checkTarget(e),a.has(e)&&a.get(e).destroy(),this._target=e,this._subscribers=new Set,this._scrollMetric=h._resolveMetric(e),this._boundEventListener=this._onTargetScroll.bind(this),this._target.addEventListener(o,this._boundEventListener),a.set(e,this)}return t(h,[{key:"subscribe",value:function(e){h._checkSubscriber(e),this._subscribers.add(e)}},{key:"unsubscribe",value:function(e){this._subscribers.delete(e)}},{key:"destroy",value:function(){a.delete(this._target),this._target.removeEventListener(o,this._boundEventListener),this._target=null,this._subscribers=null,this._scrollMetric=null,this._boundEventListener=null}},{key:"_onTargetScroll",value:function(e){var t=this._scrollMetric;this._scrollMetric=h._resolveMetric(this._target);var n=!0,r=!1,o=void 0;try{for(var i,u=_[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=i.value.resolve(t,this._scrollMetric,e);if(c&&c instanceof Event){var s=!0,l=!1,a=void 0;try{for(var f,v=this._subscribers[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){f.value.dispatchEvent(c)}}catch(e){l=!0,a=e}finally{try{s||null==v.return||v.return()}finally{if(l)throw a}}}}}catch(e){r=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw o}}}}],[{key:"of",value:function(e){return h._checkTarget(e),a.has(e)?a.get(e):new h(e)}},{key:"registerResolver",value:function(e){this._checkResolver(e),_.add(e)}},{key:"unregisterResolver",value:function(e){_.delete(e)}},{key:"reset",value:function(){a.forEach(function(e){return e.destroy()}),_.clear()}},{key:"_initByData",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=document.querySelectorAll(d)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value,u=i.dataset[y];if(u){var c=!0,s=!1,l=void 0;try{for(var a,f=document.querySelectorAll(u)[Symbol.iterator]();!(c=(a=f.next()).done);c=!0){var v=a.value;h.of(v).subscribe(i)}}catch(e){s=!0,l=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw l}}}else h.of(window).subscribe(i)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"_resolveMetric",value:function(e){var t;if(e instanceof Window)t=new v(e.innerHeight,e.innerWidth,e.pageYOffset,e.pageXOffset);else{if(!(e instanceof Element))throw new Error("Can not resolve ScrollMetric");t=new v(e.scrollHeight,e.scrollWidth,e.scrollTop,e.scrollLeft)}return t}},{key:"_checkTarget",value:function(e){for(var t=0;t<l.length;t++){if(e instanceof l[t])return}throw new Error("The target must be an instance of one in ".concat(l.map(function(e){return e.name}).join(", "),"!"))}},{key:"_checkSubscriber",value:function(t){var e=["addEventListener","removeEventListener","dispatchEvent"];if(!e.every(function(e){return t[e]instanceof Function}))throw new Error("The subscriber must have functions ".concat(e,"!"))}},{key:"_checkResolver",value:function(e){if(!(e instanceof g))throw new Error("The resolver must be an instance of Resolver!")}},{key:"VERSION",get:function(){return"0.1.0"}},{key:"monitorMap",get:function(){return new Map(a)}},{key:"resolvers",get:function(){return new Set(_)}}]),h}(),v=function(){function o(e,t,n,r){i(this,o),this._height=e,this._width=t,this._top=n,this._left=r}return t(o,[{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"top",get:function(){return this._top}},{key:"left",get:function(){return this._left}}]),o}(),window.addEventListener(s,function(){f._initByData()}),f),m=(h='[data-monitor~="scroll-up"]',p="scrollUpClass",b="scroll-up",w={SCROLL_UP:"scroll.up.".concat(g.NAMESPACE),SCROLL_UP_OFF:"scroll.up.off.".concat(g.NAMESPACE),DOM_CONTENT_LOADED:"DOMContentLoaded"},E=function(e){function o(){return i(this,o),c(this,n(o).apply(this,arguments))}return t(o,[{key:"resolve",value:function(e,t){var n=e.top,r=t.top;return o._createEvent(r<n?w.SCROLL_UP:w.SCROLL_UP_OFF)}},{key:"eventTypes",get:function(){return[w.SCROLL_UP,w.SCROLL_UP_OFF]}}],[{key:"_createEvent",value:function(e){if(document.documentMode){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return new Event(e)}},{key:"_initByData",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=function(){var e=r.value,t=e.dataset[p]||b;e.addEventListener(w.SCROLL_UP,function(){e.classList.add(t)}),e.addEventListener(w.SCROLL_UP_OFF,function(){e.classList.remove(t)})},i=document.querySelectorAll(h)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)o()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"VERSION",get:function(){return"0.1.0"}}]),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");u(e.prototype,t&&t.prototype),t&&u(e,t)}(o,e),o}(g),window.addEventListener(w.DOM_CONTENT_LOADED,function(){k.registerResolver(new E),E._initByData()}),E);e.Resolver=g,e.Monitor=k,e.ScrollUp=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=scroll-monitor.umd.min.js.map